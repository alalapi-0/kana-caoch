<!--
  äº”åéŸ³æµ‹éªŒç»“æ„è¯´æ˜ï¼š
  - é¡¶éƒ¨ä½¿ç”¨ Cell å±•ç¤ºè¿›åº¦ä¿¡æ¯ï¼›
  - é¢˜ç›®å¡ç‰‡åŒ…å«å‡åã€æç¤ºä¸è¿›åº¦æ¡ï¼›
  - Vant Form + Field æä¾›è¾“å…¥æ ¡éªŒï¼›
  - ç»“æœåŒºä»¥å¡ç‰‡åˆ—å‡ºæ¯é¢˜è¯¦æƒ…å’Œæ˜Ÿçº§ã€‚
-->
<view class="quiz-page">
  <van-cell-group inset="true" class="quiz-header">
    <van-cell
      title="é¢˜ç›®è¿›åº¦"
      value="{{current ? index + 1 : total}} / {{total}}"
      label="è¯·å¡«å†™å¯¹åº”ç½—é©¬éŸ³"
      border="false"
    />
  </van-cell-group>

  <view class="quiz-card">
    <view class="quiz-kana" wx:if="{{current}}">{{current.kana}}</view>
    <view class="quiz-kana quiz-kana--complete" wx:else>å…¨éƒ¨å®Œæˆ ğŸ‰</view>
    <view class="quiz-hint">æ ‡å‡†ç­”æ¡ˆï¼š{{current ? current.romaji : 'è¯·å‰å¾€ç»“æœé¡µæŸ¥çœ‹'}} </view>
    <van-progress percentage="{{progressPercent}}" stroke-width="8" />
  </view>

  <van-form bindsubmit="submit" class="quiz-form">
    <van-field
      label="ç½—é©¬éŸ³"
      placeholder="è¯·è¾“å…¥ç­”æ¡ˆï¼Œä¾‹å¦‚ ka"
      value="{{userInput}}"
      bind:change="onFieldChange"
      error-message="{{fieldError}}"
      border="false"
    />
    <view class="quiz-actions">
      <van-button round="true" block="true" type="primary" form-type="submit">æäº¤ç­”æ¡ˆ</van-button>
      <van-button round="true" block="true" type="default" bindtap="goResult">æŸ¥çœ‹ç»“æœ</van-button>
    </view>
  </van-form>

  <view class="quiz-results" wx:if="{{results.length}}">
    <view class="quiz-results__title">æœ¬æ¬¡ä½œç­”è®°å½•</view>
    <block wx:for="{{results}}" wx:key="{{item.kana}}-{{index}}">
      <view class="quiz-result-card">
        <van-cell
          title="{{item.kana}} â†’ {{item.romaji}}"
          label="ä½ çš„ç­”æ¡ˆï¼š{{item.user || 'æœªå¡«å†™'}}"
          border="false"
        />
        <view class="quiz-result-meta">
          <text>å‡†ç¡®ç‡ {{(item.accuracy * 100).toFixed(0)}}%</text>
          <text>ç¼–è¾‘è·ç¦» {{item.distance}}</text>
        </view>
        <star-rating stars="{{item.stars}}" />
      </view>
    </block>
  </view>

  <van-toast id="van-toast" />
</view>
